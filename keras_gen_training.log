
Attaching package: â€˜tensorflowâ€™

The following objects are masked from â€˜package:keras3â€™:

    set_random_seed, shape

========================================
Training Keras CNN Model (Generator)
========================================

/home/ubuntu/.cache/R/reticulate/uv/cache/archive-v0/W_HW3d1VeVbVLEX6FqPXL/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
TensorFlow version: 2.20.0 

Loading datasets from directories...
Found 13517 files belonging to 11 classes.
Using 10814 files for training.
Found 13517 files belonging to 11 classes.
Using 2703 files for validation.
Classes: PSA_1, PSA_1.5, PSA_10, PSA_2, PSA_3, PSA_4, PSA_5, PSA_6, PSA_7, PSA_8, PSA_9 
Number of classes: 11 

========================================
Building MobileNetV2 model with augmentation...
========================================
Downloading data from https://storage.googleapis.com/tensorflow/keras-applications/mobilenet_v2/mobilenet_v2_weights_tf_dim_ordering_tf_kernels_1.0_224_no_top.h5
[1m      0/9406464[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 0s/step[1m  81920/9406464[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m5s[0m 1us/step[1m 417792/9406464[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m2s[0m 0us/step[1m2187264/9406464[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 0us/step[1m8806400/9406464[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 0us/step[1m9406464/9406464[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 0us/step
Model built successfully.
Model: "functional_1"
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”“
â”ƒ Layer (type)                  â”ƒ Output Shape           â”ƒ     Param # â”ƒ Traiâ€¦ â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”©
â”‚ input_layer_1 (InputLayer)    â”‚ (None, 224, 224, 3)    â”‚           0 â”‚   -   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ rescaling (Rescaling)         â”‚ (None, 224, 224, 3)    â”‚           0 â”‚   -   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ data_augmentation             â”‚ (None, 224, 224, 3)    â”‚           0 â”‚   -   â”‚
â”‚ (Sequential)                  â”‚                        â”‚             â”‚       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ mobilenetv2_1.00_224          â”‚ (None, 7, 7, 1280)     â”‚   2,257,984 â”‚   N   â”‚
â”‚ (Functional)                  â”‚                        â”‚             â”‚       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ global_average_pooling2d      â”‚ (None, 1280)           â”‚           0 â”‚   -   â”‚
â”‚ (GlobalAveragePooling2D)      â”‚                        â”‚             â”‚       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ dropout (Dropout)             â”‚ (None, 1280)           â”‚           0 â”‚   -   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ dense (Dense)                 â”‚ (None, 256)            â”‚     327,936 â”‚   Y   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ dropout_1 (Dropout)           â”‚ (None, 256)            â”‚           0 â”‚   -   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ dense_1 (Dense)               â”‚ (None, 11)             â”‚       2,827 â”‚   Y   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
 Total params: 2,588,747 (9.88 MB)
 Trainable params: 330,763 (1.26 MB)
 Non-trainable params: 2,257,984 (8.61 MB)

========================================
Setting up callbacks...
========================================

========================================
Phase 1: Training with frozen base (10 epochs)
========================================
Epoch 1/10

Epoch 1: val_accuracy improved from None to 0.16204, saving model to models/psa_mobilenet_gen.keras

Epoch 1: finished saving model to models/psa_mobilenet_gen.keras
338/338 - 95s - 280ms/step - accuracy: 0.1433 - loss: 2.3976 - val_accuracy: 0.1620 - val_loss: 2.2325 - learning_rate: 1.0000e-04
Epoch 2/10

Epoch 2: val_accuracy improved from 0.16204 to 0.17314, saving model to models/psa_mobilenet_gen.keras

Epoch 2: finished saving model to models/psa_mobilenet_gen.keras
338/338 - 91s - 270ms/step - accuracy: 0.1547 - loss: 2.2591 - val_accuracy: 0.1731 - val_loss: 2.1947 - learning_rate: 1.0000e-04
Epoch 3/10

Epoch 3: val_accuracy did not improve from 0.17314
338/338 - 91s - 269ms/step - accuracy: 0.1524 - loss: 2.2251 - val_accuracy: 0.1591 - val_loss: 2.1714 - learning_rate: 1.0000e-04
Epoch 4/10

Epoch 4: val_accuracy improved from 0.17314 to 0.17684, saving model to models/psa_mobilenet_gen.keras

Epoch 4: finished saving model to models/psa_mobilenet_gen.keras
338/338 - 88s - 262ms/step - accuracy: 0.1594 - loss: 2.2169 - val_accuracy: 0.1768 - val_loss: 2.1482 - learning_rate: 1.0000e-04
Epoch 5/10

Epoch 5: val_accuracy improved from 0.17684 to 0.18091, saving model to models/psa_mobilenet_gen.keras

Epoch 5: finished saving model to models/psa_mobilenet_gen.keras
338/338 - 94s - 277ms/step - accuracy: 0.1632 - loss: 2.2031 - val_accuracy: 0.1809 - val_loss: 2.1412 - learning_rate: 1.0000e-04
Epoch 6/10

Epoch 6: val_accuracy improved from 0.18091 to 0.19793, saving model to models/psa_mobilenet_gen.keras

Epoch 6: finished saving model to models/psa_mobilenet_gen.keras
338/338 - 92s - 273ms/step - accuracy: 0.1654 - loss: 2.1988 - val_accuracy: 0.1979 - val_loss: 2.1249 - learning_rate: 1.0000e-04
Epoch 7/10

Epoch 7: val_accuracy did not improve from 0.19793
338/338 - 97s - 288ms/step - accuracy: 0.1646 - loss: 2.1908 - val_accuracy: 0.1805 - val_loss: 2.1304 - learning_rate: 1.0000e-04
Epoch 8/10

Epoch 8: val_accuracy did not improve from 0.19793
338/338 - 92s - 274ms/step - accuracy: 0.1688 - loss: 2.1867 - val_accuracy: 0.1931 - val_loss: 2.1179 - learning_rate: 1.0000e-04
Epoch 9/10

Epoch 9: val_accuracy improved from 0.19793 to 0.21051, saving model to models/psa_mobilenet_gen.keras

Epoch 9: finished saving model to models/psa_mobilenet_gen.keras
338/338 - 93s - 274ms/step - accuracy: 0.1691 - loss: 2.1846 - val_accuracy: 0.2105 - val_loss: 2.1139 - learning_rate: 1.0000e-04
Epoch 10/10

Epoch 10: val_accuracy improved from 0.21051 to 0.23011, saving model to models/psa_mobilenet_gen.keras

Epoch 10: finished saving model to models/psa_mobilenet_gen.keras
338/338 - 72s - 213ms/step - accuracy: 0.1684 - loss: 2.1770 - val_accuracy: 0.2301 - val_loss: 2.1025 - learning_rate: 1.0000e-04
Restoring model weights from the end of the best epoch: 10.

========================================
Phase 2: Fine-tuning (unfreeze last 30 layers)
========================================
Error in py_set_attr(x, name, value) : 
  AttributeError: `Model.layers` attribute is reserved and should not be used. Please use another name.
Run `reticulate::py_last_error()` for details.
Calls: $<- -> $<-.python.builtin.object -> py_set_attr
Execution halted
