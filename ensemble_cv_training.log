randomForest 4.7-1.2
Type rfNews() to see new features/changes/bug fixes.
Linking to ImageMagick 6.9.12.98
Enabled features: fontconfig, freetype, fftw, heic, lcms, pango, raw, webp, x11
Disabled features: cairo, ghostscript, rsvg
Using 4 threads
========================================
Ensemble Training with Cross-Validation
========================================

Loading cached features...
Dataset: 8123 images, 280 features
Classes: PSA_1, PSA_1.5, PSA_10, PSA_2, PSA_3, PSA_4, PSA_5, PSA_6, PSA_7, PSA_8, PSA_9 

========================================
5-Fold Cross-Validation
========================================

=== Fold 1 / 5 ===
  Upsampling training data...
  Training samples: 8313 
  Training RF Classification...
  Training RF Regression...
  Training XGBoost...
  RF: 47.4%, XGB: 9.5%, RF_Reg: 32.0%, Ensemble: 18.8%

=== Fold 2 / 5 ===
  Upsampling training data...
  Training samples: 8214 
  Training RF Classification...
  Training RF Regression...
  Training XGBoost...
  RF: 48.2%, XGB: 9.4%, RF_Reg: 31.4%, Ensemble: 19.4%

=== Fold 3 / 5 ===
  Upsampling training data...
  Training samples: 8324 
  Training RF Classification...
  Training RF Regression...
  Training XGBoost...
  RF: 51.1%, XGB: 9.2%, RF_Reg: 31.8%, Ensemble: 20.4%

=== Fold 4 / 5 ===
  Upsampling training data...
  Training samples: 8262 
  Training RF Classification...
  Training RF Regression...
  Training XGBoost...
  RF: 49.1%, XGB: 8.6%, RF_Reg: 31.2%, Ensemble: 20.4%

=== Fold 5 / 5 ===
  Upsampling training data...
  Training samples: 8382 
  Training RF Classification...
  Training RF Regression...
  Training XGBoost...
  RF: 48.7%, XGB: 9.7%, RF_Reg: 30.0%, Ensemble: 19.8%

========================================
CROSS-VALIDATION RESULTS
========================================

Per-Fold Accuracy (%):
  RF_Acc XGB_Acc RF_Reg_Acc Ensemble_Acc
1   47.4     9.5       32.0         18.8
2   48.2     9.4       31.4         19.4
3   51.1     9.2       31.8         20.4
4   49.1     8.6       31.2         20.4
5   48.7     9.7       30.0         19.8

--- Summary Statistics ---
RF Classification:  Mean = 48.9% (SD = 1.4%)
XGBoost:            Mean = 9.3% (SD = 0.4%)
RF Regression:      Mean = 31.3% (SD = 0.8%)
Ensemble (Avg):     Mean = 19.8% (SD = 0.7%)

--- Grade Proximity Analysis ---
Exact match:      19.8%
Within 1 grade:   55.8%
Within 2 grades:  79.3%

--- Per-Class Accuracy (Ensemble) ---
  PSA_1: 1.7% (238 samples)
  PSA_1.5: 0.0% (80 samples)
  PSA_10: 5.6% (1077 samples)
  PSA_2: 15.1% (285 samples)
  PSA_3: 21.0% (310 samples)
  PSA_4: 28.5% (966 samples)
  PSA_5: 25.9% (626 samples)
  PSA_6: 25.7% (1402 samples)
  PSA_7: 26.9% (931 samples)
  PSA_8: 22.3% (1009 samples)
  PSA_9: 13.4% (1199 samples)

========================================
Training Final Ensemble on All Data
========================================
Final training samples: 10369 
Training final RF Classification (300 trees)...
Training final RF Regression (300 trees)...
Training final XGBoost (150 rounds)...

Saving models...
Ensemble saved: models/psa_ensemble_cv.rds

========================================
TRAINING COMPLETE
========================================
